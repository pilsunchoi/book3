
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>4.2 SU Asset Distribution &#8212; 데이터 기반 사회과학 분석</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/042_SU_Asset_Distribution';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.3 MLE에서 파라미터 제약조건 처리법" href="043_MLE%EC%97%90%EC%84%9C_%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0_%EC%A0%9C%EC%95%BD%EC%A1%B0%EA%B1%B4_%EC%B2%98%EB%A6%AC%EB%B2%95.html" />
    <link rel="prev" title="4.1 순자산 분포 추정: Johnson SU 분포 활용" href="041_%EC%88%9C%EC%9E%90%EC%82%B0_%EB%B6%84%ED%8F%AC_%EC%B6%94%EC%A0%95_Johnson_SU_%EB%B6%84%ED%8F%AC_%ED%99%9C%EC%9A%A9.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="000_%EC%84%9C%EB%AC%B8.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="데이터 기반 사회과학 분석 - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="데이터 기반 사회과학 분석 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="000_%EC%84%9C%EB%AC%B8.html">
                    시작하며
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="010_%EB%8B%A4%EB%AC%B8%ED%99%94%EC%B2%AD%EC%86%8C%EB%85%84_%ED%95%99%EC%97%85%EC%84%B1%EC%B7%A8%EB%8F%84_%EB%B6%84%EC%84%9D.html">1 다문화청소년 학업성취도 분석</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="011_%EB%8B%A4%EB%AC%B8%ED%99%94%EC%B2%AD%EC%86%8C%EB%85%84_%ED%95%99%EC%97%85%EC%84%B1%EC%B7%A8%EB%8F%84_%EC%9A%94%EC%9D%B8_%ED%83%90%EC%83%89.html">1.1 다문화청소년 학업성취도 요인 탐색</a></li>
<li class="toctree-l2"><a class="reference internal" href="012_%EB%8B%A4%EB%AC%B8%ED%99%94%EC%B2%AD%EC%86%8C%EB%85%84%ED%8C%A8%EB%84%90_%EB%8D%B0%EC%9D%B4%ED%84%B0.html">1.2 다문화청소년패널 데이터</a></li>
<li class="toctree-l2"><a class="reference internal" href="013_%ED%8C%A8%EB%84%90_%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D.html">1.3 패널 회귀분석</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="020_%EB%8B%A4%EB%AC%B8%ED%99%94_%EB%B0%B0%EA%B2%BD%EA%B3%BC_%ED%95%99%EC%97%85%EC%84%B1%EC%A0%81.html">2 다문화 배경과 학업성적</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="021_%EB%8B%A4%EB%AC%B8%ED%99%94_%EB%B0%B0%EA%B2%BD%EC%9D%B4_%ED%95%99%EC%97%85%EC%84%B1%EC%A0%81%EC%97%90_%EB%AF%B8%EC%B9%98%EB%8A%94_%EC%98%81%ED%96%A5.html">2.1 다문화 배경이 학업성적에 미치는 영향</a></li>
<li class="toctree-l2"><a class="reference internal" href="022_%EC%95%84%EC%B2%AD%ED%8C%A8%EB%84%90%EB%B6%84%EC%84%9D%282010_e4%29.html">2.2 아청패널분석(2010 초4 패널)</a></li>
<li class="toctree-l2"><a class="reference internal" href="023_%EC%95%84%EC%B2%AD%ED%8C%A8%EB%84%90%EB%B6%84%EC%84%9D%282010_%EC%A2%85%ED%95%A9%29.html">2.3 아청패널분석(2010 종합)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="030_%ED%95%9C%EA%B5%AD_%EC%B2%AD%EB%85%84%EC%84%B8%EB%8C%80_%EC%9E%90%EC%82%B0%EB%B6%88%ED%8F%89%EB%93%B1_%EC%B6%94%EC%A0%95.html">3 한국 청년세대 자산불평등 추정</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="031_%EA%B0%80%EA%B3%84%EA%B8%88%EC%9C%B5%EC%A1%B0%EC%82%AC_%EC%A7%80%EB%8B%88%EA%B3%84%EC%88%98_%EA%B3%84%EC%82%B0.html">3.1 가계금융조사 지니계수 계산</a></li>
<li class="toctree-l2"><a class="reference internal" href="032_%EC%B2%AD%EB%85%84%EC%84%B8%EB%8C%80_%EC%A7%80%EB%8B%88%EA%B3%84%EC%88%98_%EC%B6%94%EC%9D%B4.html">3.2 청년세대 지니계수 추이</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="040_%EC%88%9C%EC%9E%90%EC%82%B0_%EB%B6%84%ED%8F%AC_%EC%B6%94%EC%A0%95.html">4 순자산 분포 추정</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="041_%EC%88%9C%EC%9E%90%EC%82%B0_%EB%B6%84%ED%8F%AC_%EC%B6%94%EC%A0%95_Johnson_SU_%EB%B6%84%ED%8F%AC_%ED%99%9C%EC%9A%A9.html">4.1 순자산 분포 추정: Johnson SU 분포 활용</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">4.2 SU Asset Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="043_MLE%EC%97%90%EC%84%9C_%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0_%EC%A0%9C%EC%95%BD%EC%A1%B0%EA%B1%B4_%EC%B2%98%EB%A6%AC%EB%B2%95.html">4.3 MLE에서 파라미터 제약조건 처리법</a></li>
<li class="toctree-l2"><a class="reference internal" href="044_MLE%EC%97%90%EC%84%9C_%EC%9E%90%EC%BD%94%EB%B9%84%EC%95%88_%EB%B0%8F_%ED%97%A4%EC%8B%9C%EC%95%88_%ED%99%9C%EC%9A%A9.html">4.4 MLE에서 헤시안 활용</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="050_%EB%82%98%EC%9D%B4%EB%B3%84_%EC%88%9C%EC%9E%90%EC%82%B0_%EB%B6%84%ED%8F%AC_%EC%B6%94%EC%A0%95.html">5 나이별 순자산 분포 추정</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="051_%EB%82%98%EC%9D%B4%EB%B3%84_%EC%88%9C%EC%9E%90%EC%82%B0_%EB%B6%84%ED%8F%AC_%EC%B6%94%EC%A0%95_SU_%EB%B6%84%ED%8F%AC_%ED%99%9C%EC%9A%A9.html">5.1 나이별 순자산 분포 추정: SU 분포 활용</a></li>
<li class="toctree-l2"><a class="reference internal" href="052_Bivariate_SU.html">5.2 Bivariate SU Distribution</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pilsunchoi/book3" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pilsunchoi/book3/issues/new?title=Issue%20on%20page%20%2Fnotebooks/042_SU_Asset_Distribution.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/042_SU_Asset_Distribution.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>4.2 SU Asset Distribution</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">1 Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#su">SU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-normal">Log-normal</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">2 Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3 지니계수 계산 및 선행연구와 비교</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">단순 지니계수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">가중 지니계수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">결과 설명</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#net-worth-in-2022">4 Net Worth in 2022</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">주요 통계량</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#su-weighted-mle">SU 분포 Weighted MLE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vs-pdf">히스토그램 vs. 모델 기반 PDF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">로렌츠 곡선 및 지니계수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">결과 비교</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#income-in-2022">5 Income in 2022</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">주요 통계량</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">SU 분포 Weighted MLE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">히스토그램 vs. 모델 기반 PDF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">로렌츠 곡선 및 지니계수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">결과 비교</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#income-in-2022-with-log-normal">6 Income in 2022 with Log-normal</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">주요 통계량</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-normal-weighted-mle">Log-normal 분포 Weighted MLE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">히스토그램 vs. 모델 기반 PDF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">로렌츠 곡선 및 지니계수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">결과 비교</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy-opt-minimize">부록: scipy.opt.minimize 사용법</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="su-asset-distribution">
<h1>4.2 SU Asset Distribution<a class="headerlink" href="#su-asset-distribution" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="#1-Functions"><span class="xref myst">1 Functions</span></a></p></li>
<li><p><a class="reference internal" href="#2-Data"><span class="xref myst">2 Data</span></a></p></li>
<li><p><a class="reference internal" href="#3-%EC%A7%80%EB%8B%88%EA%B3%84%EC%88%98-%EA%B3%84%EC%82%B0-%EB%B0%8F-%EC%84%A0%ED%96%89%EC%97%B0%EA%B5%AC%EC%99%80-%EB%B9%84%EA%B5%90"><span class="xref myst">3 지니계수 계산 및 선행연구와 비교</span></a></p></li>
<li><p><a class="reference internal" href="#4-Net-Worth-in-2022"><span class="xref myst">4 Net Worth in 2022</span></a></p></li>
<li><p><a class="reference internal" href="#5-Income-in-2022"><span class="xref myst">5 Income in 2022</span></a></p></li>
<li><p><a class="reference internal" href="#6-Income-in-2022-with-Log-normal"><span class="xref myst">6 Income in 2022 with Log-normal</span></a></p></li>
<li><p><a class="reference internal" href="#%EB%B6%80%EB%A1%9D:-scipy.opt.minimize-%EC%82%AC%EC%9A%A9%EB%B2%95"><span class="xref myst">부록: scipy.opt.minimize 사용법</span></a></p></li>
</ul>
<section id="functions">
<h2>1 Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<section id="su">
<h3>SU<a class="headerlink" href="#su" title="Link to this heading">#</a></h3>
<p><strong>PDF</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">SU_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>

    <span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">theta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span><span class="o">/</span><span class="n">theta</span>
    <span class="n">pdf_vals</span> <span class="o">=</span> <span class="n">J</span><span class="o">*</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">pdf_vals</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Log Likelihood Function</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">s</span></code>(<span class="math notranslate nohighlight">\(s\)</span>)와 <code class="docutils literal notranslate"><span class="pre">theta</span></code>(<span class="math notranslate nohighlight">\(\theta\)</span>)가 항상 양수이기 때문에 최적화 과정에서 이 조건을 부과하기 위해 이들 파라미터에 지수(natural exponential)를 취해서 로그가능도 함수를 만드는 방법을 사용한다. 이렇게 하면 입력 파라미터는 제약(bounding) 조건이 사라지고 모든 실수값을 취할 수 있게 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">weight_ll_SU_e</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    
    <span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">theta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span><span class="o">/</span><span class="n">theta</span>

    <span class="n">ln_pdf_vals</span> <span class="o">=</span> <span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">log_lik_val</span> <span class="o">=</span> <span class="n">ln_pdf_vals</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">log_lik_val</span>
</pre></div>
</div>
</div>
</div>
<p><strong>MLE Objective Function</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">weight_obj_SU_e</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

    <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">params</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=</span> <span class="n">args</span>
    
    <span class="n">log_lik_val</span> <span class="o">=</span> <span class="n">weight_ll_SU_e</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">neg_log_lik_val</span> <span class="o">=</span> <span class="o">-</span><span class="n">log_lik_val</span>
    
    <span class="k">return</span> <span class="n">neg_log_lik_val</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Mean and Variance</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">SU_mean</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">theta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="n">s</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">lambda_</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mean</span>

<span class="k">def</span> <span class="nf">SU_var</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">theta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">variance</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">lambda_</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">variance</span>

<span class="k">def</span> <span class="nf">SU_skew</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">theta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">lambda_</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">mu_3</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">lambda_</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">lambda_</span><span class="p">))</span>
    <span class="n">skewness</span> <span class="o">=</span> <span class="n">mu_3</span><span class="o">/</span><span class="p">(</span><span class="n">sigma</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">skewness</span>

<span class="k">def</span> <span class="nf">SU_kurt</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">theta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">lambda_</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">mu_4</span> <span class="o">=</span> <span class="mf">0.125</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">lambda_</span><span class="p">)</span>
                                  <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">lambda_</span><span class="p">)</span> 
                                  <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">kurtosis</span> <span class="o">=</span> <span class="n">mu_4</span><span class="o">/</span><span class="p">(</span><span class="n">sigma</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">kurtosis</span>
</pre></div>
</div>
</div>
</div>
<p><strong>CDF and PPF</strong></p>
<ul class="simple">
<li><p>PPF stands for Probability Point Function. The PPF is the inverse of the CDF (cumulative distribution function). It returns the exact point where the probability of everything to the left is equal to y.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">SU_cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span><span class="o">/</span><span class="n">theta</span>
    <span class="n">prob</span>  <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">prob</span>

<span class="k">def</span> <span class="nf">SU_ppf</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    
    <span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="n">lambda_</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">m</span>

    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Lorenz Curve</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Lorenz_SU</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">theta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lambda_</span><span class="p">)</span><span class="o">*</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span>
         <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">lambda_</span><span class="p">)</span><span class="o">*</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="n">theta</span><span class="p">))</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mf">0.5</span><span class="o">*</span><span class="n">v</span>
    <span class="n">den</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="n">s</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">lambda_</span><span class="p">)</span>
    <span class="n">Lorenz</span>  <span class="o">=</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>

    <span class="k">return</span> <span class="n">Lorenz</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="log-normal">
<h3>Log-normal<a class="headerlink" href="#log-normal" title="Link to this heading">#</a></h3>
<p><strong>PDF</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">LN_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>

    <span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">sigma</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span>
    <span class="n">pdf_vals</span> <span class="o">=</span> <span class="n">J</span><span class="o">*</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">pdf_vals</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Log Likelihood Function</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">weight_ll_LN_e</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>

    <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">sigma</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span>

    <span class="n">ln_pdf_vals</span> <span class="o">=</span> <span class="n">weight</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">log_lik_val</span> <span class="o">=</span> <span class="n">ln_pdf_vals</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">log_lik_val</span>
</pre></div>
</div>
</div>
</div>
<p><strong>MLE Objective Function</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">weight_obj_LN_e</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

    <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">params</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=</span> <span class="n">args</span>
    
    <span class="n">log_lik_val</span> <span class="o">=</span> <span class="n">weight_ll_LN_e</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">neg_log_lik_val</span> <span class="o">=</span> <span class="o">-</span><span class="n">log_lik_val</span>
    
    <span class="k">return</span> <span class="n">neg_log_lik_val</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Mean and Variance</strong></p>
<div class="math notranslate nohighlight">
\[
\text{Mean:  }\exp\left(\mu + \frac{\sigma^2}{2}\right)
\]</div>
<div class="math notranslate nohighlight">
\[
\text{Variance:  }\left[\exp(\sigma^2) - 1\right] \exp\left(2\mu + \sigma^2\right)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">LN_mean</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mean</span>

<span class="k">def</span> <span class="nf">LN_var</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="n">variance</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">variance</span>

<span class="k">def</span> <span class="nf">LN_skewness</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="n">skewness</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">skewness</span>

<span class="k">def</span> <span class="nf">LN_kurtosis</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="n">kurtosis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span>
    
    <span class="k">return</span> <span class="n">kurtosis</span> 
</pre></div>
</div>
</div>
</div>
<p><strong>CDF and PPF</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">LN_cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span>
    <span class="n">prob</span>  <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">prob</span>

<span class="k">def</span> <span class="nf">LN_ppf</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span><span class="o">*</span><span class="n">sigma</span> <span class="o">+</span> <span class="n">mu</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Lorenz Curve</strong></p>
<div class="math notranslate nohighlight">
\[
L(p) = \Phi\left(\Phi^{-1}(p) - \sigma\right)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="k">def</span> <span class="nf">Lorenz_LN</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="n">Phi_inv</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="c1"># Φ^{-1}(p), 표준정규분포의 CDF의 역함수</span>
    <span class="n">L_p</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">Phi_inv</span> <span class="o">-</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">L_p</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data">
<h2>2 Data<a class="headerlink" href="#data" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.federalreserve.gov/econres/scfindex.htm">Survey of Consumer Finances (SCF)</a></p></li>
<li><p><a class="reference external" href="https://sda.berkeley.edu/sdaweb/analysis/?dataset=scfcomb2022">Code Book</a></p></li>
</ul>
<p>미국은 SCF가 3년 주기로 행해지는데, 2022년 SCF의 경우, <a class="reference external" href="https://www.aeaweb.org/forum/1850/survey-consumer-finances-invites-comments-proposed-approach">2022년 4월부터 2023년 3월까지 본 조사(main survey)가 행해졌고</a>, 연간 소득 등의 변수는 2021년을 기준으로 조사됐고, 자산이나 부채 등은 조사 시점을 기준으로 조사됐다. SCF 보고서는 모든 금액에 대해 CPI를 사용해 인플레이션 효과를 제거한 숫자를 사용해 분석하는 반면, (관측별 가중치를 제공하지만) 가중 평균 등은 사용하지 않는다.</p>
<p><strong>압축파일 다운로드 및 압축풀기</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="k">def</span> <span class="nf">unzip_survey_file</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">io</span><span class="o">,</span> <span class="nn">zipfile</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1989</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.federalreserve.gov/econresdata/scf/files/&#39;</span>\
        <span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;_scf&#39;</span><span class="o">+</span><span class="n">year</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">+</span><span class="s1">&#39;bs.zip&#39;</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.federalreserve.gov/econres/files/scfp&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;s.zip&#39;</span>    

    <span class="n">url</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">url_unzipped</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">url_unzipped</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">url_unzipped</span><span class="o">.</span><span class="n">namelist</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p><strong>SCF 데이터 추정</strong></p>
<ul class="simple">
<li><p>각 가구별로 5개의 관측을 <strong>모두</strong> 사용함</p></li>
<li><p>단위를 천달러로 변경</p></li>
</ul>
</section>
<section id="id1">
<h2>3 지니계수 계산 및 선행연구와 비교<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p><img alt="JPE 지니계수 계산" src="https://raw.githubusercontent.com/pilsunchoi/images3/main/4-7.png" /></p>
<ul class="simple">
<li><p>출처: Kuhn, M., Schularick, M., &amp; Steins, U. I. (2020). Income and wealth inequality in America, 1949–2016. <em>Journal of Political Economy</em>, 128(9), 3469-3519.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># 처리할 연도 목록 정의</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1989&#39;</span><span class="p">,</span> <span class="s1">&#39;2007&#39;</span><span class="p">,</span> <span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;2022&#39;</span><span class="p">]</span>

<span class="c1"># 결과를 저장할 딕셔너리 초기화</span>
<span class="n">networth_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">income_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">weight_dict</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="c1"># 데이터 로드</span>
    <span class="n">scf_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="n">unzip_survey_file</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">))</span>
    
    <span class="c1"># 변수 추출 및 딕셔너리에 저장</span>

    <span class="n">networth_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;networth_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scf_data</span><span class="p">[</span><span class="s1">&#39;networth&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span>
    <span class="n">income_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;income_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scf_data</span><span class="p">[</span><span class="s1">&#39;income&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span>
    <span class="n">weight_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;weight_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scf_data</span><span class="p">[</span><span class="s1">&#39;wgt&#39;</span><span class="p">]</span>
    
<span class="c1"># 2022년 변수에 접근</span>
<span class="n">networth_2022</span> <span class="o">=</span> <span class="n">networth_dict</span><span class="p">[</span><span class="s1">&#39;networth_2022&#39;</span><span class="p">]</span>
<span class="n">income_2022</span> <span class="o">=</span> <span class="n">income_dict</span><span class="p">[</span><span class="s1">&#39;income_2022&#39;</span><span class="p">]</span>
<span class="n">weight_2022</span> <span class="o">=</span> <span class="n">weight_dict</span><span class="p">[</span><span class="s1">&#39;weight_2022&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h3>단순 지니계수<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gini_coefficient</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">sorted_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">coef</span> <span class="o">+=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sorted_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">coef</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_x</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">coef</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Net Worth</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="n">gini</span> <span class="o">=</span> <span class="n">gini_coefficient</span><span class="p">(</span><span class="n">networth_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;networth_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;단순 gini of networth_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">,</span> <span class="n">gini</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>단순 gini of networth_1989: 0.9003073834599726
단순 gini of networth_2007: 0.914225449601566
단순 gini of networth_2016: 0.940408724174731
단순 gini of networth_2022: 0.9369407959316021
</pre></div>
</div>
</div>
</div>
<p><strong>Income</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="n">gini</span> <span class="o">=</span> <span class="n">gini_coefficient</span><span class="p">(</span><span class="n">income_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;income_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;단순 gini of income_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">,</span> <span class="n">gini</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>단순 gini of income_1989: 0.841289699130467
단순 gini of income_2007: 0.9003082665154276
단순 gini of income_2016: 0.8939910729408329
단순 gini of income_2022: 0.9217346139192073
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>가중 지니계수<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>계산방식 출처: Lerman, R. I., &amp; Yitzhaki, S. (1989). Improving the accuracy of estimates of Gini coefficients. <em>Journal of econometrics</em>, 42(1), 43-47.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 가중평균 함수</span>
<span class="k">def</span> <span class="nf">weighted_mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
    <span class="n">weighted_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span>
    <span class="n">total_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">weighted_sum</span> <span class="o">/</span> <span class="n">total_weight</span>
    <span class="k">return</span> <span class="n">mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># weighted_gini 함수</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">weighted_gini</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
    <span class="c1"># 데이터를 값 순서대로 정렬</span>
    <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>  <span class="c1"># x 기준 오름차순으로 정렬</span>
    <span class="n">sorted_x</span><span class="p">,</span> <span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># 총 가중치 및 누적 가중치 초기화</span>
    <span class="n">total_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
    <span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_w</span><span class="o">/</span><span class="n">total_weight</span>
    <span class="n">cumulative_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
     
    <span class="c1"># 지니 계수 계산 항목</span>
    <span class="n">sorted_x_dev</span> <span class="o">=</span> <span class="n">sorted_x</span> <span class="o">-</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">sorted_x</span><span class="p">,</span> <span class="n">sorted_w</span><span class="p">)</span>
    
    <span class="n">f_hat</span> <span class="o">=</span> <span class="n">cumulative_weight</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>    
    <span class="c1"># f_hat 업데이트</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f_hat</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>            
            <span class="n">f_hat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sorted_w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f_hat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cumulative_weight</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">sorted_w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">f_hat_dev</span> <span class="o">=</span> <span class="n">f_hat</span> <span class="o">-</span> <span class="n">f_hat</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">sorted_w</span><span class="o">*</span><span class="n">sorted_x_dev</span><span class="o">*</span><span class="n">f_hat_dev</span><span class="o">/</span><span class="p">(</span><span class="n">weighted_mean</span><span class="p">(</span><span class="n">sorted_x</span><span class="p">,</span> <span class="n">sorted_w</span><span class="p">))</span>
    <span class="n">weighted_gini</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
   
    <span class="k">return</span> <span class="n">weighted_gini</span> 
</pre></div>
</div>
</div>
</div>
<p><strong>Net Worth</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="n">gini</span> <span class="o">=</span> <span class="n">weighted_gini</span><span class="p">(</span><span class="n">networth_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;networth_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span>
                         <span class="n">weight_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;weight_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;가중 gini of networth_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">,</span> <span class="n">gini</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>가중 gini of networth_1989: 0.7901580486056661
가중 gini of networth_2007: 0.8161574733915097
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>가중 gini of networth_2016: 0.8595617108886233
가중 gini of networth_2022: 0.8298282302964242
</pre></div>
</div>
</div>
</div>
<p><strong>Income</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="n">gini</span> <span class="o">=</span> <span class="n">weighted_gini</span><span class="p">(</span><span class="n">income_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;income_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span>
                         <span class="n">weight_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;weight_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;가중 gini of income_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">,</span> <span class="n">gini</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>가중 gini of income_1989: 0.5402317643421131
가중 gini of income_2007: 0.5741591995511028
가중 gini of income_2016: 0.5977057737870368
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>가중 gini of income_2022: 0.6068066016844815
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>결과 설명<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>위 선행연구 결과와 비교해보면, SCF 데이터세트를 이용하여 지니계수를 구할 경우 가중치를 사용하여 계산한다는 것을 알 수 있다.</p></li>
<li><p>순자산은 계산 결과가 동일하고, 소득은 수치가 약간 다름.</p></li>
</ul>
</section>
</section>
<section id="net-worth-in-2022">
<h2>4 Net Worth in 2022<a class="headerlink" href="#net-worth-in-2022" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">networth_2022</span> <span class="o">=</span> <span class="n">networth_dict</span><span class="p">[</span><span class="s1">&#39;networth_2022&#39;</span><span class="p">]</span>
<span class="n">weight_2022</span> <span class="o">=</span> <span class="n">weight_dict</span><span class="p">[</span><span class="s1">&#39;weight_2022&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">networth_2022</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">weight_2022</span><span class="o">/</span><span class="p">(</span><span class="n">weight_2022</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">X</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count      22975.00
mean       19956.40
std       110170.72
min         -555.50
25%           35.91
50%          384.50
75%         2476.11
max      2387780.90
Name: networth, dtype: object
</pre></div>
</div>
</div>
</div>
<section id="id5">
<h3>주요 통계량<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">moment</span>

<span class="k">def</span> <span class="nf">weighted_mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">weights</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">weighted_moment</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span> <span class="o">*</span> <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="n">order</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">weighted_std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="n">variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span> <span class="o">*</span> <span class="p">((</span><span class="n">data</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">weighted_skewness</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">weighted_moment</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">m3</span> <span class="o">=</span> <span class="n">weighted_moment</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">skewness</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">))</span> <span class="o">*</span> <span class="n">m3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m2</span> <span class="o">**</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">skewness</span>

<span class="k">def</span> <span class="nf">weighted_kurtosis</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">weighted_moment</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">m4</span> <span class="o">=</span> <span class="n">weighted_moment</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">kurtosis</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">*</span> <span class="n">m4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m2</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kurtosis</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Mean:&quot;</span><span class="p">,</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted S.D.:&quot;</span><span class="p">,</span> <span class="n">weighted_std</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Skewness:&quot;</span><span class="p">,</span> <span class="n">weighted_skewness</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Kurtosis:&quot;</span><span class="p">,</span> <span class="n">weighted_kurtosis</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weighted Mean: 1059.457470450531
Weighted S.D.: 8085.433431879704
Weighted Skewness: 92.75847008732033
Weighted Kurtosis: 14517.33006547197
</pre></div>
</div>
</div>
</div>
<p><strong>가중 지니계수</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;가중 gini_2022:&#39;</span><span class="p">,</span> <span class="n">weighted_gini</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>가중 gini_2022: 0.8298282302964242
</pre></div>
</div>
</div>
</div>
<p><strong>가중 히스토그램</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 필터링</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">400</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X</span> <span class="o">&lt;=</span> <span class="mi">2000</span><span class="p">)</span>  <span class="c1"># [-400, 2000] 범위에 속하는 관측만 선택</span>
<span class="n">X_filtered</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">w_filtered</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>  <span class="c1"># 가중치도 동일하게 필터링</span>

<span class="c1"># 히스토그램 그리기</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Net Worth (thousand dollars)&#39;</span><span class="p">)</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X_filtered</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">w_filtered</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.010</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6e9e239e4d997acb315bd0f8aa13530b7e8aa98402e18817ed4eed101e0488dd.png" src="../_images/6e9e239e4d997acb315bd0f8aa13530b7e8aa98402e18817ed4eed101e0488dd.png" />
</div>
</div>
</section>
<section id="su-weighted-mle">
<h3>SU 분포 Weighted MLE<a class="headerlink" href="#su-weighted-mle" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[\text{argmax} \sum_i w_i \log L(m,s,\lambda, \theta \mid x_i)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m_init</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">s_init</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">lambda_init</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">theta_init</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">params_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">m_init</span><span class="p">,</span> <span class="n">s_init</span><span class="p">,</span> <span class="n">lambda_init</span><span class="p">,</span> <span class="n">theta_init</span><span class="p">])</span>
<span class="n">res_SU</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">weight_obj_SU_e</span><span class="p">,</span> <span class="n">params_init</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span>
                      <span class="n">method</span><span class="o">=</span><span class="s1">&#39;L-BFGS-B&#39;</span><span class="p">)</span>
<span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span> <span class="o">=</span> <span class="n">res_SU</span><span class="o">.</span><span class="n">x</span>

<span class="n">s_MLE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s_MLE</span><span class="p">)</span>
<span class="n">theta_MLE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">theta_MLE</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;m_MLE =&#39;</span><span class="p">,</span><span class="n">m_MLE</span><span class="p">,</span> <span class="s1">&#39;s_MLE =&#39;</span><span class="p">,</span><span class="n">s_MLE</span><span class="p">,</span> <span class="s1">&#39;lambda_MLE =&#39;</span><span class="p">,</span><span class="n">lambda_MLE</span><span class="p">,</span>
      <span class="s1">&#39;theta_MLE =&#39;</span><span class="p">,</span><span class="n">theta_MLE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Objective function value at solution:&quot;</span><span class="p">,</span> <span class="n">res_SU</span><span class="o">.</span><span class="n">fun</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m_MLE = -4.353749207460307 s_MLE = 14.875830115629578 lambda_MLE = 3.045945510181015 theta_MLE = 2.089705981181354
Objective function value at solution: 7.430483707764102
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_SU</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  message: CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
  success: True
   status: 0
      fun: 7.430483707764102
        x: [-4.354e+00  2.700e+00  3.046e+00  7.370e-01]
      nit: 31
      jac: [-8.882e-08 -3.553e-07 -1.066e-06  1.243e-06]
     nfev: 170
     njev: 34
 hess_inv: &lt;4x4 LbfgsInvHessProduct with dtype=float64&gt;
</pre></div>
</div>
</div>
</div>
<p><strong>평균 표준편차 왜도 첨도</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Mean:&quot;</span><span class="p">,</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted S.D.:&quot;</span><span class="p">,</span> <span class="n">weighted_std</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Skewness:&quot;</span><span class="p">,</span> <span class="n">weighted_skewness</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Kurtosis:&quot;</span><span class="p">,</span> <span class="n">weighted_kurtosis</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weighted Mean: 1059.457470450531
Weighted S.D.: 8085.433431879704
Weighted Skewness: 92.75847008732033
Weighted Kurtosis: 14517.33006547197
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean:&quot;</span><span class="p">,</span> <span class="n">SU_mean</span><span class="p">(</span><span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;S.D.:&quot;</span><span class="p">,</span> <span class="n">SU_var</span><span class="p">(</span><span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skewness:&quot;</span><span class="p">,</span> <span class="n">SU_skew</span><span class="p">(</span><span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kurtosis:&quot;</span><span class="p">,</span> <span class="n">SU_kurt</span><span class="p">(</span><span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean: 1380.9960373971508
S.D.: 12247.19698572734
Skewness: 712.5804967909689
Kurtosis: 39542847.94181715
</pre></div>
</div>
</div>
</div>
</section>
<section id="vs-pdf">
<h3>히스토그램 vs. 모델 기반 PDF<a class="headerlink" href="#vs-pdf" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 새로운 그림을 생성하고 해상도를 조정</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Net Worth (thousand dollars)&#39;</span><span class="p">)</span>

<span class="c1"># 데이터 필터링</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">400</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X</span> <span class="o">&lt;=</span> <span class="mi">2000</span><span class="p">)</span>  <span class="c1"># [-400, 2000] 범위에 속하는 관측만 선택</span>
<span class="n">X_filtered</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">w_filtered</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>  <span class="c1"># 가중치도 동일하게 필터링</span>

<span class="c1"># 히스토그램 그리기</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X_filtered</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">w_filtered</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.010</span><span class="p">)</span>

<span class="c1"># Plot the MLE estimated distribution</span>
<span class="n">dist_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">SU_pdf</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">),</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$S_U$ distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="c1"># 세로축 눈금을 설정</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.010</span><span class="p">])</span>

<span class="c1"># 그래프 표시</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f3ed48e1c22d9882e857246c6ee2b8a7bd4ce90f884a57087e71e48038a85d34.png" src="../_images/f3ed48e1c22d9882e857246c6ee2b8a7bd4ce90f884a57087e71e48038a85d34.png" />
</div>
</div>
</section>
<section id="id6">
<h3>로렌츠 곡선 및 지니계수<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p><strong>가중치 사용</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># 데이터를 값 순서대로 정렬</span>
<span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">X</span><span class="p">)]</span>
<span class="n">sorted_x</span><span class="p">,</span> <span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    
<span class="c1"># 총 가중치 및 가중치가 적용된 누적 소득 계산</span>
<span class="n">total_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
<span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_w</span> <span class="o">/</span> <span class="n">total_weight</span>
<span class="n">cumulative_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
    
<span class="c1"># 가중치가 적용된 누적 소득 비율 계산</span>
<span class="n">total_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span>
<span class="n">weighted_cumulative_percentage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_x</span>

<span class="n">lorenz_curve_x</span> <span class="o">=</span> <span class="n">cumulative_w</span>
<span class="n">lorenz_curve_y</span> <span class="o">=</span> <span class="n">weighted_cumulative_percentage</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lorenz_curve_x</span><span class="p">,</span> <span class="n">lorenz_curve_y</span><span class="p">,</span> 
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lorenz Curve&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Population share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Net worth share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Gini 계수 계산</span>
<span class="n">area_under_lorenz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">lorenz_curve_y</span><span class="p">,</span> <span class="n">lorenz_curve_x</span><span class="p">)</span>
<span class="n">area_under_equality</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># 0에서 1 사이의 대각선 선분 아래 영역</span>
<span class="n">gini_coefficient</span> <span class="o">=</span> <span class="p">(</span><span class="n">area_under_equality</span> <span class="o">-</span> <span class="n">area_under_lorenz</span><span class="p">)</span> <span class="o">/</span> <span class="n">area_under_equality</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;가중 Gini Coefficient: </span><span class="si">{</span><span class="n">gini_coefficient</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/65fb792eb9de59a88a800a68ea772515b3124e2b820a7f6fd3d7e2e352ecc3e2.png" src="../_images/65fb792eb9de59a88a800a68ea772515b3124e2b820a7f6fd3d7e2e352ecc3e2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>가중 Gini Coefficient: 0.8298
</pre></div>
</div>
</div>
</div>
<p><strong>Parametric Estimation 결과</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">dist_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">Lorenz_SU</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">),</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$S_U$ Lorenz Curve&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Population share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Net worth share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bc127e7bdf8b7a0a40dd3013be1126ef00f17b7a9360aa2c41ebbaaf6cbbfed3.png" src="../_images/bc127e7bdf8b7a0a40dd3013be1126ef00f17b7a9360aa2c41ebbaaf6cbbfed3.png" />
</div>
</div>
<p><strong>지니계수 계산(수치 적분)</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>

<span class="n">res</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">Lorenz_SU</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">))</span>
<span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8671225715403752
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h3>결과 비교<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 새로운 그림을 생성하고 해상도를 조정합니다.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="c1"># Empirical Lorenz 곡선</span>
<span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">X</span><span class="p">)]</span>
<span class="n">sorted_x</span><span class="p">,</span> <span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    
<span class="n">total_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
<span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_w</span> <span class="o">/</span> <span class="n">total_weight</span>
<span class="n">cumulative_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
    
<span class="n">total_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span>
<span class="n">weighted_cumulative_percentage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_x</span>

<span class="n">lorenz_curve_x</span> <span class="o">=</span> <span class="n">cumulative_w</span>
<span class="n">lorenz_curve_y</span> <span class="o">=</span> <span class="n">weighted_cumulative_percentage</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lorenz_curve_x</span><span class="p">,</span> <span class="n">lorenz_curve_y</span><span class="p">,</span> 
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical Lorenz curve&#39;</span><span class="p">)</span>

<span class="c1"># SU Lorenz 곡선</span>
<span class="n">dist_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">Lorenz_SU</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">),</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$S_U$ Lorenz curve&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Population share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Net worth share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8428a40eaa96b7a239dca6150029d0a394cfffcea64800cd14d2e3b8440772fb.png" src="../_images/8428a40eaa96b7a239dca6150029d0a394cfffcea64800cd14d2e3b8440772fb.png" />
</div>
</div>
</section>
</section>
<section id="income-in-2022">
<h2>5 Income in 2022<a class="headerlink" href="#income-in-2022" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income_2022</span> <span class="o">=</span> <span class="n">income_dict</span><span class="p">[</span><span class="s1">&#39;income_2022&#39;</span><span class="p">]</span>
<span class="n">weight_2022</span> <span class="o">=</span> <span class="n">weight_dict</span><span class="p">[</span><span class="s1">&#39;weight_2022&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">income_2022</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">weight_2022</span><span class="o">/</span><span class="p">(</span><span class="n">weight_2022</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">X</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     22975.00
mean       1592.86
std       12442.71
min           0.00
25%          42.16
50%          94.04
75%         264.82
max      458230.95
Name: income, dtype: object
</pre></div>
</div>
</div>
</div>
<section id="id8">
<h3>주요 통계량<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Mean:&quot;</span><span class="p">,</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted S.D.:&quot;</span><span class="p">,</span> <span class="n">weighted_std</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Skewness:&quot;</span><span class="p">,</span> <span class="n">weighted_skewness</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Kurtosis:&quot;</span><span class="p">,</span> <span class="n">weighted_kurtosis</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weighted Mean: 141.38988867115881
Weighted S.D.: 727.9620604300843
Weighted Skewness: 166.76137348884768
Weighted Kurtosis: 63910.5666748011
</pre></div>
</div>
</div>
</div>
<p><strong>가중 지니계수</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;가중 gini_2022:&#39;</span><span class="p">,</span> <span class="n">weighted_gini</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>가중 gini_2022: 0.6068066016844815
</pre></div>
</div>
</div>
</div>
<p><strong>가중 히스토그램</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 필터링</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">180</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">X_filtered</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">w_filtered</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>  <span class="c1"># 가중치도 동일하게 필터링</span>

<span class="c1"># 히스토그램 그리기</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Income (thousand dollars)&#39;</span><span class="p">)</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X_filtered</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">w_filtered</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.012</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/943b52d5b3d8bd07e37e36c0953c70d878ab6e84a14f64d8a6f8cddf03f2c081.png" src="../_images/943b52d5b3d8bd07e37e36c0953c70d878ab6e84a14f64d8a6f8cddf03f2c081.png" />
</div>
</div>
</section>
<section id="id9">
<h3>SU 분포 Weighted MLE<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m_init</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">s_init</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">lambda_init</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">theta_init</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">params_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">m_init</span><span class="p">,</span> <span class="n">s_init</span><span class="p">,</span> <span class="n">lambda_init</span><span class="p">,</span> <span class="n">theta_init</span><span class="p">])</span>
<span class="n">res_SU</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">weight_obj_SU_e</span><span class="p">,</span> <span class="n">params_init</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span>
                      <span class="n">method</span><span class="o">=</span><span class="s1">&#39;L-BFGS-B&#39;</span><span class="p">)</span>
<span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span> <span class="o">=</span> <span class="n">res_SU</span><span class="o">.</span><span class="n">x</span>

<span class="n">s_MLE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s_MLE</span><span class="p">)</span>
<span class="n">theta_MLE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">theta_MLE</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;m_MLE =&#39;</span><span class="p">,</span><span class="n">m_MLE</span><span class="p">,</span> <span class="s1">&#39;s_MLE =&#39;</span><span class="p">,</span><span class="n">s_MLE</span><span class="p">,</span> <span class="s1">&#39;lambda_MLE =&#39;</span><span class="p">,</span><span class="n">lambda_MLE</span><span class="p">,</span>
      <span class="s1">&#39;theta_MLE =&#39;</span><span class="p">,</span><span class="n">theta_MLE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Objective function value at solution:&quot;</span><span class="p">,</span> <span class="n">res_SU</span><span class="o">.</span><span class="n">fun</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m_MLE = 7.614629481975043 s_MLE = 10.954576510596073 lambda_MLE = 2.427072425919873 theta_MLE = 1.130466271104921
Objective function value at solution: 5.727623010890738
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_SU</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  message: CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH
  success: True
   status: 0
      fun: 5.727623010890738
        x: [ 7.615e+00  2.394e+00  2.427e+00  1.226e-01]
      nit: 36
      jac: [ 0.000e+00 -9.415e-06 -5.329e-06 -1.386e-05]
     nfev: 200
     njev: 40
 hess_inv: &lt;4x4 LbfgsInvHessProduct with dtype=float64&gt;
</pre></div>
</div>
</div>
</div>
<p><strong>평균 표준편차 왜도 첨도</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Mean:&quot;</span><span class="p">,</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted S.D.:&quot;</span><span class="p">,</span> <span class="n">weighted_std</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Skewness:&quot;</span><span class="p">,</span> <span class="n">weighted_skewness</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Kurtosis:&quot;</span><span class="p">,</span> <span class="n">weighted_kurtosis</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weighted Mean: 141.38988867115881
Weighted S.D.: 727.9620604300843
Weighted Skewness: 166.76137348884768
Weighted Kurtosis: 63910.5666748011
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean:&quot;</span><span class="p">,</span> <span class="n">SU_mean</span><span class="p">(</span><span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;S.D.:&quot;</span><span class="p">,</span> <span class="n">SU_var</span><span class="p">(</span><span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skewness:&quot;</span><span class="p">,</span> <span class="n">SU_skew</span><span class="p">(</span><span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kurtosis:&quot;</span><span class="p">,</span> <span class="n">SU_kurt</span><span class="p">(</span><span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean: 124.22439359283459
S.D.: 189.53025842393495
Skewness: 8.945104758405455
Kurtosis: 291.7011057020838
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h3>히스토그램 vs. 모델 기반 PDF<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 새로운 그림을 생성하고 해상도를 조정</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Income (thousand dollars)&#39;</span><span class="p">)</span>

<span class="c1"># 데이터 필터링</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">180</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">X_filtered</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">w_filtered</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>  <span class="c1"># 가중치도 동일하게 필터링</span>

<span class="c1"># 히스토그램 그리기</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X_filtered</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">w_filtered</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.012</span><span class="p">)</span>

<span class="c1"># Plot the MLE estimated distribution</span>
<span class="n">dist_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">SU_pdf</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">),</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$S_U$ distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="c1"># 세로축 눈금을 설정</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.012</span><span class="p">])</span>

<span class="c1"># 그래프 표시</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d683f172ab56fd941dd3a361d1b409ff558306a3c28e060fb91dcafe6bf4362d.png" src="../_images/d683f172ab56fd941dd3a361d1b409ff558306a3c28e060fb91dcafe6bf4362d.png" />
</div>
</div>
</section>
<section id="id11">
<h3>로렌츠 곡선 및 지니계수<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># 데이터를 값 순서대로 정렬</span>
<span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">X</span><span class="p">)]</span>
<span class="n">sorted_x</span><span class="p">,</span> <span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    
<span class="c1"># 총 가중치 및 가중치가 적용된 누적 소득 계산</span>
<span class="n">total_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
<span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_w</span> <span class="o">/</span> <span class="n">total_weight</span>
<span class="n">cumulative_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
    
<span class="c1"># 가중치가 적용된 누적 소득 비율 계산</span>
<span class="n">total_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span>
<span class="n">weighted_cumulative_percentage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_x</span>

<span class="n">lorenz_curve_x</span> <span class="o">=</span> <span class="n">cumulative_w</span>
<span class="n">lorenz_curve_y</span> <span class="o">=</span> <span class="n">weighted_cumulative_percentage</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lorenz_curve_x</span><span class="p">,</span> <span class="n">lorenz_curve_y</span><span class="p">,</span> 
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lorenz Curve&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Population share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Net worth share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Gini 계수 계산</span>
<span class="n">area_under_lorenz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">lorenz_curve_y</span><span class="p">,</span> <span class="n">lorenz_curve_x</span><span class="p">)</span>
<span class="n">area_under_equality</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># 0에서 1 사이의 대각선 선분 아래 영역</span>
<span class="n">gini_coefficient</span> <span class="o">=</span> <span class="p">(</span><span class="n">area_under_equality</span> <span class="o">-</span> <span class="n">area_under_lorenz</span><span class="p">)</span> <span class="o">/</span> <span class="n">area_under_equality</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;가중 Gini Coefficient: </span><span class="si">{</span><span class="n">gini_coefficient</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/368301c23bd543787aa2f7bc06d2b213763535d63dc639118fd6d3115b31e1f6.png" src="../_images/368301c23bd543787aa2f7bc06d2b213763535d63dc639118fd6d3115b31e1f6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>가중 Gini Coefficient: 0.6068
</pre></div>
</div>
</div>
</div>
<p><strong>Parametric Estimation 결과</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">dist_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">Lorenz_SU</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">),</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$S_U$ Lorenz Curve&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Population share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Income share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a6fd69fbea8f135ec6748cf1f91e0eaadcabc727af0f2d66f3eb1e0149431d93.png" src="../_images/a6fd69fbea8f135ec6748cf1f91e0eaadcabc727af0f2d66f3eb1e0149431d93.png" />
</div>
</div>
<p><strong>지니계수 계산(수치 적분)</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>

<span class="n">res</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">Lorenz_SU</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">))</span>
<span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5491117368397265
</pre></div>
</div>
</div>
</div>
</section>
<section id="id12">
<h3>결과 비교<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 새로운 그림을 생성하고 해상도를 조정합니다.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="c1"># Empirical Lorenz 곡선</span>
<span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">X</span><span class="p">)]</span>
<span class="n">sorted_x</span><span class="p">,</span> <span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    
<span class="n">total_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
<span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_w</span> <span class="o">/</span> <span class="n">total_weight</span>
<span class="n">cumulative_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
    
<span class="n">total_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span>
<span class="n">weighted_cumulative_percentage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_x</span>

<span class="n">lorenz_curve_x</span> <span class="o">=</span> <span class="n">cumulative_w</span>
<span class="n">lorenz_curve_y</span> <span class="o">=</span> <span class="n">weighted_cumulative_percentage</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lorenz_curve_x</span><span class="p">,</span> <span class="n">lorenz_curve_y</span><span class="p">,</span> 
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical Lorenz curve&#39;</span><span class="p">)</span>

<span class="c1"># SU Lorenz 곡선</span>
<span class="n">dist_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">Lorenz_SU</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">m_MLE</span><span class="p">,</span> <span class="n">s_MLE</span><span class="p">,</span> <span class="n">lambda_MLE</span><span class="p">,</span> <span class="n">theta_MLE</span><span class="p">),</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$S_U$ Lorenz curve&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Population share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Income share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2f56ef08b1218ac87426e41a239ea59925d3dc622d6a8963c083e579e9ef8315.png" src="../_images/2f56ef08b1218ac87426e41a239ea59925d3dc622d6a8963c083e579e9ef8315.png" />
</div>
</div>
</section>
</section>
<section id="income-in-2022-with-log-normal">
<h2>6 Income in 2022 with Log-normal<a class="headerlink" href="#income-in-2022-with-log-normal" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income_2022</span> <span class="o">=</span> <span class="n">income_dict</span><span class="p">[</span><span class="s1">&#39;income_2022&#39;</span><span class="p">]</span>
<span class="n">weight_2022</span> <span class="o">=</span> <span class="n">weight_dict</span><span class="p">[</span><span class="s1">&#39;weight_2022&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;소득이 0인 가구&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">income_2022</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;전체 가구&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">income_2022</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;소득이 0인 가구의 비중(%)&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">income_2022</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">income_2022</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>소득이 0인 가구 39.4
전체 가구 4595.0
소득이 0인 가구의 비중(%) 0.8574537540805224
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">income_2022</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">weight_2022</span><span class="o">/</span><span class="p">(</span><span class="n">weight_2022</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">X</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     22975.00
mean       1592.86
std       12442.71
min           0.00
25%          42.16
50%          94.04
75%         264.82
max      458230.95
Name: income, dtype: object
</pre></div>
</div>
</div>
</div>
<section id="id13">
<h3>주요 통계량<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Mean:&quot;</span><span class="p">,</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted S.D.:&quot;</span><span class="p">,</span> <span class="n">weighted_std</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Skewness:&quot;</span><span class="p">,</span> <span class="n">weighted_skewness</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Kurtosis:&quot;</span><span class="p">,</span> <span class="n">weighted_kurtosis</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weighted Mean: 141.38988871023287
Weighted S.D.: 727.962060422495
Weighted Skewness: 166.76137349390837
Weighted Kurtosis: 63910.56667743045
</pre></div>
</div>
</div>
</div>
<p><strong>가중 지니계수</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;가중 gini_2022:&#39;</span><span class="p">,</span> <span class="n">weighted_gini</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>가중 gini_2022: 0.6068066012415092
</pre></div>
</div>
</div>
</div>
<p><strong>가중 히스토그램</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 필터링</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">180</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">X_filtered</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">w_filtered</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>  <span class="c1"># 가중치도 동일하게 필터링</span>

<span class="c1"># 히스토그램 그리기</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Income (thousand dollars)&#39;</span><span class="p">)</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X_filtered</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">w_filtered</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.012</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ffb8605e2f8379d46b7bcf51438f62dc48d688882ad17bf6f175412eac874967.png" src="../_images/ffb8605e2f8379d46b7bcf51438f62dc48d688882ad17bf6f175412eac874967.png" />
</div>
</div>
</section>
<section id="log-normal-weighted-mle">
<h3>Log-normal 분포 Weighted MLE<a class="headerlink" href="#log-normal-weighted-mle" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu_init</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma_init</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">params_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mu_init</span><span class="p">,</span> <span class="n">sigma_init</span><span class="p">])</span>
<span class="n">res_LN</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">weight_obj_LN_e</span><span class="p">,</span> <span class="n">params_init</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;L-BFGS-B&#39;</span><span class="p">)</span>
<span class="n">mu_MLE</span><span class="p">,</span> <span class="n">sigma_MLE</span> <span class="o">=</span> <span class="n">res_LN</span><span class="o">.</span><span class="n">x</span>

<span class="n">sigma_MLE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sigma_MLE</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mu_MLE =&#39;</span><span class="p">,</span><span class="n">mu_MLE</span><span class="p">,</span> <span class="s1">&#39;sigma_MLE =&#39;</span><span class="p">,</span><span class="n">sigma_MLE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Objective function value at solution:&quot;</span><span class="p">,</span> <span class="n">res_LN</span><span class="o">.</span><span class="n">fun</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mu_MLE = 4.21175826006971 sigma_MLE = 1.4272366593555585
Objective function value at solution: 5.986443965958112
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_LN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  message: CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
  success: True
   status: 0
      fun: 5.986443965958112
        x: [ 4.212e+00  3.557e-01]
      nit: 17
      jac: [-2.043e-06 -5.063e-06]
     nfev: 57
     njev: 19
 hess_inv: &lt;2x2 LbfgsInvHessProduct with dtype=float64&gt;
</pre></div>
</div>
</div>
</div>
<p><strong>평균 표준편차 왜도 첨도</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Mean:&quot;</span><span class="p">,</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted S.D.:&quot;</span><span class="p">,</span> <span class="n">weighted_std</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Skewness:&quot;</span><span class="p">,</span> <span class="n">weighted_skewness</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weighted Kurtosis:&quot;</span><span class="p">,</span> <span class="n">weighted_kurtosis</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weighted Mean: 141.38988871023287
Weighted S.D.: 727.962060422495
Weighted Skewness: 166.76137349390837
Weighted Kurtosis: 63910.56667743045
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean:&quot;</span><span class="p">,</span> <span class="n">LN_mean</span><span class="p">(</span><span class="n">mu_MLE</span><span class="p">,</span> <span class="n">sigma_MLE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;S.D.:&quot;</span><span class="p">,</span> <span class="n">LN_var</span><span class="p">(</span><span class="n">mu_MLE</span><span class="p">,</span> <span class="n">sigma_MLE</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skewness:&quot;</span><span class="p">,</span> <span class="n">LN_skewness</span><span class="p">(</span><span class="n">mu_MLE</span><span class="p">,</span> <span class="n">sigma_MLE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kurtosis:&quot;</span><span class="p">,</span> <span class="n">LN_kurtosis</span><span class="p">(</span><span class="n">mu_MLE</span><span class="p">,</span> <span class="n">sigma_MLE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean: 186.8414695659069
S.D.: 482.4565966647683
Skewness: 24.96341122034233
Kurtosis: 4531.488434776198
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h3>히스토그램 vs. 모델 기반 PDF<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 새로운 그림을 생성하고 해상도를 조정</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Income (thousand dollars)&#39;</span><span class="p">)</span>

<span class="c1"># 데이터 필터링</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">180</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">X_filtered</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">w_filtered</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="c1"># 히스토그램 그리기</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X_filtered</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">w_filtered</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.012</span><span class="p">)</span>

<span class="c1"># Plot the MLE estimated distribution</span>
<span class="n">dist_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">LN_pdf</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">mu_MLE</span><span class="p">,</span> <span class="n">sigma_MLE</span><span class="p">),</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Log-normal distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="c1"># 세로축 눈금을 설정</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.012</span><span class="p">])</span>

<span class="c1"># 그래프 표시</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/71fa2b1aedf2385b0a51a71f5e72ece7f020dd50d9037348f08081dd402964a9.png" src="../_images/71fa2b1aedf2385b0a51a71f5e72ece7f020dd50d9037348f08081dd402964a9.png" />
</div>
</div>
</section>
<section id="id15">
<h3>로렌츠 곡선 및 지니계수<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># 데이터를 값 순서대로 정렬</span>
<span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">X</span><span class="p">)]</span>
<span class="n">sorted_x</span><span class="p">,</span> <span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    
<span class="c1"># 총 가중치 및 가중치가 적용된 누적 소득 계산</span>
<span class="n">total_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
<span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_w</span> <span class="o">/</span> <span class="n">total_weight</span>
<span class="n">cumulative_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
    
<span class="c1"># 가중치가 적용된 누적 소득 비율 계산</span>
<span class="n">total_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span>
<span class="n">weighted_cumulative_percentage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_x</span>

<span class="n">lorenz_curve_x</span> <span class="o">=</span> <span class="n">cumulative_w</span>
<span class="n">lorenz_curve_y</span> <span class="o">=</span> <span class="n">weighted_cumulative_percentage</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lorenz_curve_x</span><span class="p">,</span> <span class="n">lorenz_curve_y</span><span class="p">,</span> 
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lorenz Curve&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Population share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Net worth share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Gini 계수 계산</span>
<span class="n">area_under_lorenz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">lorenz_curve_y</span><span class="p">,</span> <span class="n">lorenz_curve_x</span><span class="p">)</span>
<span class="n">area_under_equality</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># 0에서 1 사이의 대각선 선분 아래 영역</span>
<span class="n">gini_coefficient</span> <span class="o">=</span> <span class="p">(</span><span class="n">area_under_equality</span> <span class="o">-</span> <span class="n">area_under_lorenz</span><span class="p">)</span> <span class="o">/</span> <span class="n">area_under_equality</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;가중 Gini Coefficient: </span><span class="si">{</span><span class="n">gini_coefficient</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/368301c23bd543787aa2f7bc06d2b213763535d63dc639118fd6d3115b31e1f6.png" src="../_images/368301c23bd543787aa2f7bc06d2b213763535d63dc639118fd6d3115b31e1f6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>가중 Gini Coefficient: 0.6068
</pre></div>
</div>
</div>
</div>
<p><strong>Parametric Estimation 결과</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">dist_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">Lorenz_LN</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">sigma_MLE</span><span class="p">),</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Log-normal Lorenz Curve&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Population share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Income share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0013854877713ec8ef827c0dd0841be401f6486319e1426544cadabfae067646.png" src="../_images/0013854877713ec8ef827c0dd0841be401f6486319e1426544cadabfae067646.png" />
</div>
</div>
<p><strong>지니계수</strong></p>
<div class="math notranslate nohighlight">
\[
2\Phi\left(\frac{\sigma}{\sqrt{2}}\right) - 1
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gini</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">sigma_MLE</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">gini</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6871254545732142
</pre></div>
</div>
</div>
</div>
<p><strong>지니계수(수치 적분)</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>

<span class="n">res</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">Lorenz_LN</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">sigma_MLE</span><span class="p">))</span>
<span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6871254545985546
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h3>결과 비교<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 새로운 그림을 생성하고 해상도를 조정합니다.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="c1"># Empirical Lorenz 곡선</span>
<span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">X</span><span class="p">)]</span>
<span class="n">sorted_x</span><span class="p">,</span> <span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sorted_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    
<span class="n">total_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
<span class="n">sorted_w</span> <span class="o">=</span> <span class="n">sorted_w</span> <span class="o">/</span> <span class="n">total_weight</span>
<span class="n">cumulative_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_w</span><span class="p">)</span>
    
<span class="n">total_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span>
<span class="n">weighted_cumulative_percentage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_x</span> <span class="o">*</span> <span class="n">sorted_w</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_x</span>

<span class="n">lorenz_curve_x</span> <span class="o">=</span> <span class="n">cumulative_w</span>
<span class="n">lorenz_curve_y</span> <span class="o">=</span> <span class="n">weighted_cumulative_percentage</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lorenz_curve_x</span><span class="p">,</span> <span class="n">lorenz_curve_y</span><span class="p">,</span> 
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical Lorenz curve&#39;</span><span class="p">)</span>

<span class="c1"># SU Lorenz 곡선</span>
<span class="n">dist_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">Lorenz_LN</span><span class="p">(</span><span class="n">dist_X</span><span class="p">,</span> <span class="n">sigma_MLE</span><span class="p">),</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Log-normal Lorenz curve&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Population share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Income share&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d9ae1db20030d499a2a7dec6a46a01e413019995e3293f7daf7a37d6f194ce55.png" src="../_images/d9ae1db20030d499a2a7dec6a46a01e413019995e3293f7daf7a37d6f194ce55.png" />
</div>
</div>
</section>
</section>
<section id="scipy-opt-minimize">
<h2>부록: scipy.opt.minimize 사용법<a class="headerlink" href="#scipy-opt-minimize" title="Link to this heading">#</a></h2>
<p><strong>파이썬에서 최대화(최소화) 문제를 설정하는 방법</strong></p>
<p>모든 최대화 문제는 최소화 문제로 다시 설정될 수 있다. 최소화 문제는 수치적으로 더 안정적이고 잘 정의되어 있기 때문에 대부분의 수치 최적화(numerical optimizer) 프로그램은 최소화 프로그램으로 설정된다. <a class="reference external" href="https://docs.scipy.org/doc/scipy-0.18.1/reference/optimize.html">scipy.optimize</a> 라이브러리에는 다양한 유형의 최소화 도구가 있다. 최대가능도 추정 문제의 경우, <a class="reference external" href="https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize">scipy.optimize.minimize()</a> 함수를 사용한다.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></strong></p>
<p>줄여서 <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code>이다. <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code> 함수에는 3개의 필수 인수와 많은 옵션이 있다. 필수 인수는 다음과 같다.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fun</span></code>: <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code>의 첫 번째 인수는 목적함수로서 <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code>는 목적함수를 최소화시키는 파라미터 값을 찾는다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x0</span></code>: 두 번째 인수는 파라미터 값에 대한 초기값이다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">args=()</span></code>: 세 번째 인수는 목적함수를 계산하는 데 필요한 모든 객체 튜플이다.</p></li>
</ol>
<p><strong>목적함수(objective function)</strong></p>
<p>목적함수는 <code class="docutils literal notranslate"><span class="pre">objective_function(params,</span> <span class="pre">*args)</span></code>의 형태이다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">params</span></code>: 첫 번째 파라미터는 스칼라 또는 값의 벡터이다. 이것은 목적함수를 최소화하기 위해 선택되는 값이다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*args</span></code>: 두 번째 파라미터는 가변 길이(variable-length) 튜플 인수이다.</p></li>
</ul>
<p><strong>제약조건 하에서의 최소화</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code> 함수에는 목적함수를 최소화하는 파라미터 값을 찾는 데 사용할 수 있는 많은 <code class="docutils literal notranslate"><span class="pre">method</span></code>가 있다. <code class="docutils literal notranslate"><span class="pre">method='MethodName'</span></code> 입력 인수를 사용하여 호출된다. 이들 중 일부는 선택되는 파라미터에 대해 상한 및 하한을 설정할 수 있는 제약조건 하에서의 최소화(bound-constrained minimization)를 허용한다. 이를 허용하는 방법은 <code class="docutils literal notranslate"><span class="pre">Nelder-Mead</span></code>, <code class="docutils literal notranslate"><span class="pre">L-BFGS-B</span></code>, <code class="docutils literal notranslate"><span class="pre">Powell</span></code>, <code class="docutils literal notranslate"><span class="pre">TNC</span></code> 등이다.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="041_%EC%88%9C%EC%9E%90%EC%82%B0_%EB%B6%84%ED%8F%AC_%EC%B6%94%EC%A0%95_Johnson_SU_%EB%B6%84%ED%8F%AC_%ED%99%9C%EC%9A%A9.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">4.1 순자산 분포 추정: Johnson SU 분포 활용</p>
      </div>
    </a>
    <a class="right-next"
       href="043_MLE%EC%97%90%EC%84%9C_%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0_%EC%A0%9C%EC%95%BD%EC%A1%B0%EA%B1%B4_%EC%B2%98%EB%A6%AC%EB%B2%95.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">4.3 MLE에서 파라미터 제약조건 처리법</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">1 Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#su">SU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-normal">Log-normal</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">2 Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3 지니계수 계산 및 선행연구와 비교</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">단순 지니계수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">가중 지니계수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">결과 설명</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#net-worth-in-2022">4 Net Worth in 2022</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">주요 통계량</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#su-weighted-mle">SU 분포 Weighted MLE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vs-pdf">히스토그램 vs. 모델 기반 PDF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">로렌츠 곡선 및 지니계수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">결과 비교</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#income-in-2022">5 Income in 2022</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">주요 통계량</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">SU 분포 Weighted MLE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">히스토그램 vs. 모델 기반 PDF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">로렌츠 곡선 및 지니계수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">결과 비교</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#income-in-2022-with-log-normal">6 Income in 2022 with Log-normal</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">주요 통계량</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-normal-weighted-mle">Log-normal 분포 Weighted MLE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">히스토그램 vs. 모델 기반 PDF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">로렌츠 곡선 및 지니계수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">결과 비교</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy-opt-minimize">부록: scipy.opt.minimize 사용법</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 최필선 민인식
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>